<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0042)http://www.hedgerwow.com/BLOG/owc/bar3.htm -->
<HTML><HEAD><TITLE>BarChart</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<STYLE> {
	FONT-FAMILY: Verdana
}
</STYLE>

<META content="MSHTML 6.00.2900.5626" name=GENERATOR></HEAD>
<BODY>
<CENTER>
<H1>Ideas about Office Web Component 10 (OWC10)</H1>
<BLOCKQUOTE>Hedger Wang</BLOCKQUOTE></CENTER>
<H3>Bar Chart</H3>Click each bar and get its key value<BR>
<OBJECT id=HHBarChart632230759575937500 hideFocus height=400 width="100%" 
classid=clsid:0002E556-0000-0000-C000-000000000046 VIEWASTEXT><PARAM NAME="XMLData" VALUE='<xml xmlns:x="urn:schemas-microsoft-com:office:excel">&#10; <x:ChartSpace>&#10;  <x:OWCVersion>10.0.0.5608         </x:OWCVersion>&#10;  <x:Width>24262</x:Width>&#10;  <x:Height>10583</x:Height>&#10;  <x:DisplayPropertyBrowser/>&#10;  <x:NoGrouping/>&#10;  <x:NoFiltering/>&#10;  <x:Palette>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#000000</x:Entry>&#10;   <x:Entry>#8080FF</x:Entry>&#10;   <x:Entry>#802060</x:Entry>&#10;   <x:Entry>#FFFFA0</x:Entry>&#10;   <x:Entry>#A0E0E0</x:Entry>&#10;   <x:Entry>#600080</x:Entry>&#10;   <x:Entry>#FF8080</x:Entry>&#10;   <x:Entry>#008080</x:Entry>&#10;   <x:Entry>#C0C0FF</x:Entry>&#10;   <x:Entry>#000080</x:Entry>&#10;   <x:Entry>#FF00FF</x:Entry>&#10;   <x:Entry>#80FFFF</x:Entry>&#10;   <x:Entry>#0080FF</x:Entry>&#10;   <x:Entry>#FF8080</x:Entry>&#10;   <x:Entry>#C0FF80</x:Entry>&#10;   <x:Entry>#FFC0FF</x:Entry>&#10;   <x:Entry>#FF80FF</x:Entry>&#10;  </x:Palette>&#10;  <x:DefaultFont>·s²Ó©úÅé</x:DefaultFont>&#10;  <x:Border>&#10;   <x:ColorIndex>None</x:ColorIndex>&#10;   <x:Weight>0</x:Weight>&#10;  </x:Border>&#10;  <x:Interior>&#10;   <x:Color>#FCFCFC</x:Color>&#10;   <x:FillEffect>&#10;    <x:fill x:type="gradient" x:color="#FCFCFC" color2="fill darken(209)"&#10;     x:angle="40" focusposition="0,0" focus="100%"/>&#10;   </x:FillEffect>&#10;  </x:Interior>&#10;  <x:Chart>&#10;   <x:PlotArea>&#10;    <x:Interior>&#10;     <x:Color>#FFFFFF</x:Color>&#10;     <x:FillEffect>&#10;      <x:fill x:type="gradient" x:color="#FFFFFF" x:color2="#D5D5D5" x:angle="0"&#10;       focusposition="0,0" focus="100%"/>&#10;     </x:FillEffect>&#10;    </x:Interior>&#10;    <x:Graph>&#10;     <x:SubType>Clustered</x:SubType>&#10;     <x:Type>Bar</x:Type>&#10;     <x:Series>&#10;      <x:Interior>&#10;       <x:Color>#87CEEB</x:Color>&#10;       <x:FillEffect>&#10;        <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;         x:angle="-135" focusposition="0,0" focus="100%"/>&#10;       </x:FillEffect>&#10;      </x:Interior>&#10;      <x:FormatMap>&#10;      </x:FormatMap>&#10;      <x:Name>LowRisk</x:Name>&#10;      <x:Caption>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>&amp;quot;LowRisk&amp;quot;</x:Data>&#10;      </x:Caption>&#10;      <x:Index>0</x:Index>&#10;      <x:Category>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>{&amp;quot;Category 1&amp;quot;,&amp;quot;Category 2&amp;quot;,&amp;quot;Category 3&amp;quot;,&amp;quot;Category 4&amp;quot;,&amp;quot;Category 5&amp;quot;,&amp;quot;Category 6&amp;quot;,&amp;quot;Category 7&amp;quot;,&amp;quot;Category 8&amp;quot;,&amp;quot;Category 9&amp;quot;,&amp;quot;Category 10&amp;quot;}</x:Data>&#10;      </x:Category>&#10;      <x:Value>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>{348.0,265.0,52.0,337.0,158.0,372.0,315.0,285.0,322.0,35.0}</x:Data>&#10;      </x:Value>&#10;      <x:DataPoint>&#10;       <x:Index>0</x:Index>&#10;       <x:Border>&#10;        <x:Color>#FF00CC</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>1</x:Index>&#10;       <x:Border>&#10;        <x:Color>#FF0066</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>2</x:Index>&#10;       <x:Border>&#10;        <x:Color>#FF0033</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>3</x:Index>&#10;       <x:Border>&#10;        <x:Color>#FF9900</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>4</x:Index>&#10;       <x:Border>&#10;        <x:Color>#FFCC00</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>5</x:Index>&#10;       <x:Border>&#10;        <x:Color>#FFFF00</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>6</x:Index>&#10;       <x:Border>&#10;        <x:Color>#CCFF00</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>7</x:Index>&#10;       <x:Border>&#10;        <x:Color>#99FF00</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>8</x:Index>&#10;       <x:Border>&#10;        <x:Color>#00FF99</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:DataPoint>&#10;       <x:Index>9</x:Index>&#10;       <x:Border>&#10;        <x:Color>#00FFFF</x:Color>&#10;        <x:Weight>0</x:Weight>&#10;       </x:Border>&#10;       <x:Interior>&#10;        <x:Color>#87CEEB</x:Color>&#10;        <x:FillEffect>&#10;         <x:fill x:type="gradient" x:color="#87CEEB" x:color2="#191970"&#10;          x:angle="-135" focusposition="0,0" focus="100%"/>&#10;        </x:FillEffect>&#10;       </x:Interior>&#10;      </x:DataPoint>&#10;      <x:Marker>&#10;       <x:Symbol>None</x:Symbol>&#10;      </x:Marker>&#10;      <x:Explode>0</x:Explode>&#10;      <x:Thickness>5</x:Thickness>&#10;     </x:Series>&#10;     <x:Series>&#10;      <x:Interior>&#10;       <x:Color>#FFA500</x:Color>&#10;       <x:FillEffect>&#10;        <x:fill x:type="gradient" x:color="#FFA500" x:color2="#F0E68C" x:angle="0"&#10;         focusposition="0,0" focus="100%"/>&#10;       </x:FillEffect>&#10;      </x:Interior>&#10;      <x:FormatMap>&#10;      </x:FormatMap>&#10;      <x:Name>MediumRisk</x:Name>&#10;      <x:Caption>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>&amp;quot;MediumRisk&amp;quot;</x:Data>&#10;      </x:Caption>&#10;      <x:Index>1</x:Index>&#10;      <x:Category>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>{&amp;quot;Category 1&amp;quot;,&amp;quot;Category 2&amp;quot;,&amp;quot;Category 3&amp;quot;,&amp;quot;Category 4&amp;quot;,&amp;quot;Category 5&amp;quot;,&amp;quot;Category 6&amp;quot;,&amp;quot;Category 7&amp;quot;,&amp;quot;Category 8&amp;quot;,&amp;quot;Category 9&amp;quot;,&amp;quot;Category 10&amp;quot;}</x:Data>&#10;      </x:Category>&#10;      <x:Value>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>{27.0,123.0,296.0,183.0,451.0,247.0,183.0,37.0,89.0,254.0}</x:Data>&#10;      </x:Value>&#10;      <x:Marker>&#10;       <x:Symbol>None</x:Symbol>&#10;      </x:Marker>&#10;      <x:Explode>0</x:Explode>&#10;      <x:Thickness>10</x:Thickness>&#10;     </x:Series>&#10;     <x:Series>&#10;      <x:Interior>&#10;       <x:Color>#FF0000</x:Color>&#10;       <x:FillEffect>&#10;        <x:fill x:type="gradient" x:color="#FF0000" x:color2="#A52A2A"&#10;         x:angle="-135" focusposition="0,0" focus="100%"/>&#10;       </x:FillEffect>&#10;      </x:Interior>&#10;      <x:FormatMap>&#10;      </x:FormatMap>&#10;      <x:Name>High Risk</x:Name>&#10;      <x:Caption>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>&amp;quot;High Risk&amp;quot;</x:Data>&#10;      </x:Caption>&#10;      <x:Index>2</x:Index>&#10;      <x:Category>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>{&amp;quot;Category 1&amp;quot;,&amp;quot;Category 2&amp;quot;,&amp;quot;Category 3&amp;quot;,&amp;quot;Category 4&amp;quot;,&amp;quot;Category 5&amp;quot;,&amp;quot;Category 6&amp;quot;,&amp;quot;Category 7&amp;quot;,&amp;quot;Category 8&amp;quot;,&amp;quot;Category 9&amp;quot;,&amp;quot;Category 10&amp;quot;}</x:Data>&#10;      </x:Category>&#10;      <x:Value>&#10;       <x:DataSourceIndex>-1</x:DataSourceIndex>&#10;       <x:Data>{24.0,33.0,228.0,39.0,345.0,271.0,62.0,380.0,20.0,390.0}</x:Data>&#10;      </x:Value>&#10;      <x:Marker>&#10;       <x:Symbol>None</x:Symbol>&#10;      </x:Marker>&#10;      <x:Explode>0</x:Explode>&#10;      <x:Thickness>10</x:Thickness>&#10;     </x:Series>&#10;     <x:Dimension>&#10;      <x:ScaleID>58402196</x:ScaleID>&#10;      <x:Index>Categories</x:Index>&#10;     </x:Dimension>&#10;     <x:Dimension>&#10;      <x:ScaleID>58402400</x:ScaleID>&#10;      <x:Index>Value</x:Index>&#10;     </x:Dimension>&#10;     <x:Overlap>0</x:Overlap>&#10;     <x:GapWidth>150</x:GapWidth>&#10;     <x:FirstSliceAngle>0</x:FirstSliceAngle>&#10;    </x:Graph>&#10;    <x:Axis>&#10;     <x:AxisID>58407456</x:AxisID>&#10;     <x:ScaleID>58402196</x:ScaleID>&#10;     <x:Type>Category</x:Type>&#10;     <x:MajorTick>Outside</x:MajorTick>&#10;     <x:MinorTick>None</x:MinorTick>&#10;     <x:Placement>Left</x:Placement>&#10;     <x:GroupingEnum>Auto</x:GroupingEnum>&#10;    </x:Axis>&#10;    <x:Axis>&#10;     <x:AxisID>58407692</x:AxisID>&#10;     <x:ScaleID>58402400</x:ScaleID>&#10;     <x:Type>Value</x:Type>&#10;     <x:MajorGridlines>&#10;     </x:MajorGridlines>&#10;     <x:MajorTick>Outside</x:MajorTick>&#10;     <x:MinorTick>None</x:MinorTick>&#10;     <x:Placement>Bottom</x:Placement>&#10;    </x:Axis>&#10;   </x:PlotArea>&#10;  </x:Chart>&#10;  <x:Legend>&#10;   <x:Placement>Top</x:Placement>&#10;  </x:Legend>&#10;  <x:Scaling>&#10;   <x:ScaleID>58402196</x:ScaleID>&#10;  </x:Scaling>&#10;  <x:Scaling>&#10;   <x:ScaleID>58402400</x:ScaleID>&#10;  </x:Scaling>&#10;  <x:HasSelectionFeedback>True</x:HasSelectionFeedback>&#10; </x:ChartSpace>&#10;</xml>'><PARAM NAME="ScreenUpdating" VALUE="-1"><PARAM NAME="EnableEvents" VALUE="-1"></OBJECT>
<SCRIPT language=JavaScript event="BeforeContextMenu(x, y, Menu, Cancel)" 
for=HHBarChart632230759575937500>ChartBeforeContextMenu(this, x, y, Menu, Cancel);;</SCRIPT>

<SCRIPT language=JavaScript event="CommandExecute(Command, Succeeded)" 
for=HHBarChart632230759575937500>ChartCommandExecute(this, Command, Succeeded);;</SCRIPT>

<SCRIPT language=javascript event=Click(Button) 
for=HHBarChart632230759575937500>ChartClick(this,this.HHKeyValue[this.Selection.Index]);;</SCRIPT>

<SCRIPT language=javascript event="MouseMove(Button,Shift,x, y )" 
for=HHBarChart632230759575937500>;</SCRIPT>

<SCRIPT language=javascript>window.attachEvent("onload",Set_HHBarChart632230759575937500_Key);function Set_HHBarChart632230759575937500_Key(){try{	document.getElementById("HHBarChart632230759575937500").HHKeyValue=new Array();	with (document.getElementById("HHBarChart632230759575937500"))	{;HHKeyValue[0]=["2","8573"];HHKeyValue[1]=["2","1692"];HHKeyValue[2]=["2","1075"];HHKeyValue[3]=["2","8516"];HHKeyValue[4]=["2","8560"];HHKeyValue[5]=["2","8499"];HHKeyValue[6]=["2","1691"];HHKeyValue[7]=["2","1883"];HHKeyValue[8]=["2","8557"];HHKeyValue[9]=["2","6128"];;}}catch(e){return};}</SCRIPT>

<SCRIPT> 



function ChartBeforeContextMenu(el, x, y, Menu, Cancel)
{
  
    	var cmContextMenu = new Array();
		var cmClearSubMenu  = new Array();
		var cmLegendSubMenu  = new Array();
		var cmViewSubMenu  = new Array();
			   
		cmClearSubMenu[0] =["AAAAA", "2.11"]
		cmClearSubMenu[1] =["BBBBB", "2.12"]
	
		
		cmLegendSubMenu[0] = ["Yes", "5.1"];
		cmLegendSubMenu[1] = ["No", "5.2"];
	
		
		
        
    if(el.Selection.Index!=null)
    {
    	//Ib?
    
		cmContextMenu[0] =["Menu Item 1", "1"]
		cmContextMenu[1] = null
		cmContextMenu[2] =["Menu Item 2", "2"]

		cmContextMenu[4] =["Menu Item 3", cmClearSubMenu];
		cmContextMenu[5] =["Menu Item 4", cmLegendSubMenu];    
	
		
		
    }
    else
  {   
        //Out Side
        cmContextMenu[0] =["Menu Item 1", "3"]
		cmContextMenu[1] =["Menu Item 2", cmClearSubMenu];      
		cmContextMenu[2] =["Menu Item 3", cmLegendSubMenu];      
		cmContextMenu[3] =null;
		cmContextMenu[4] =["Menu Item 4", cmViewSubMenu];      
		
		
    }
    
    Menu.Value = cmContextMenu;
	Cancel =true;
}

function ChartCommandExecute(el, Command, Succeeded)
{
 Command = parseFloat(Command);
 alert( Command )
  


}

function ChartClick(el,key)
{
	if(key!=null)
	{
		var IssueType = key[0];
		var IssueClass = key[1];
		alert(key + " Column:" +  el.Selection.Index)
	};
}





</SCRIPT>
</FORM></BODY></HTML>
